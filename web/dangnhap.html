<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>ÄÄƒng nháº­p tÃ i khoáº£n</title>
    <link rel="stylesheet" href="css/login.css" />
  </head>
  <body>
    <div class="login-container">
      <h2>ÄÄƒng nháº­p tÃ i khoáº£n</h2>
      <form id="login-form">
        <label for="login-username">TÃªn Ä‘Äƒng nháº­p</label>
        <div class="input-wrapper">
          <input type="text" id="login-username" required />
        </div>

        <label for="login-password">Máº­t kháº©u</label>
        <div class="input-wrapper">
          <input type="password" id="login-password" required />
          <span
            class="toggle-password"
            onclick="togglePassword('login-password', this)"
          >
            <i class="fa-solid fa-eye"></i>
          </span>
        </div>

        <label class="checkbox-label">
          <input type="checkbox" id="remember-me" /> Ghi nhá»› tÃ i khoáº£n
        </label>

        <div class="error" id="error-message"></div>

        <button type="submit" class="btn">ÄÄƒng nháº­p</button>

        <div class="register-link">
          <a href="register.html">ÄÄƒng kÃ½ tÃ i khoáº£n</a>
        </div>
      </form>
    </div>
    <script>
      // Hiá»ƒn thá»‹/áº©n máº­t kháº©u
      function togglePassword(inputId, icon) {
        const input = document.getElementById(inputId);
        const isPassword = input.type === "password";
        input.type = isPassword ? "text" : "password";
        icon.innerHTML = isPassword
          ? '<i class="fa-solid fa-eye-slash"></i>'
          : '<i class="fa-solid fa-eye"></i>';
      }

      // Tá»± Ä‘á»™ng Ä‘iá»n tÃ i khoáº£n náº¿u Ä‘Ã£ ghi nhá»›
      window.onload = () => {
        const remembered = localStorage.getItem("rememberedUsername");
        if (remembered) {
          document.getElementById("login-username").value = remembered;
          document.getElementById("remember-me").checked = true;
        }
      };

      // Xá»­ lÃ½ Ä‘Äƒng nháº­p
      document
        .getElementById("login-form")
        .addEventListener("submit", function (e) {
          e.preventDefault();

          const username = document
            .getElementById("login-username")
            .value.trim();
          const password = document.getElementById("login-password").value;

          const users = JSON.parse(localStorage.getItem("users")) || [];

          // TÃ¬m ngÆ°á»i dÃ¹ng trÃ¹ng username + password
          const foundUser = users.find(
            (user) => user.username === username && user.password === password
          );

          if (foundUser) {
            // LÆ°u Ä‘Äƒng nháº­p
            localStorage.setItem("loggedInUser", username);

            // Ghi nhá»› náº¿u Ä‘Æ°á»£c chá»n
            if (document.getElementById("remember-me").checked) {
              localStorage.setItem("rememberedUsername", username);
            } else {
              localStorage.removeItem("rememberedUsername");
            }

            alert("ğŸ‰ ÄÄƒng nháº­p thÃ nh cÃ´ng!");
            window.location.href = "index.html";
          } else {
            alert("âŒ TÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u khÃ´ng Ä‘Ãºng!");
          }
        });
    </script>
  </body>
</html>
